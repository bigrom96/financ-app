<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1e40af">
    <title>üí∞ –ú–æ–∏ –§–∏–Ω–∞–Ω—Å—ã v1.2</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        body {
            overscroll-behavior: none;
            -webkit-font-smoothing: antialiased;
            background: #f8fafc;
        }
        
        input, select, textarea {
            -webkit-appearance: none;
            appearance: none;
        }
        
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .tab-button {
            flex: 1;
            padding: 12px 6px;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 11px;
        }

        .tab-button.active {
            color: #1e40af;
            border-bottom: 3px solid #1e40af;
        }

        .account-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 16px;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .transaction-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
        }

        .transaction-card:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:active {
            transform: scale(0.95);
        }

        .btn-income {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 4px 6px rgba(16, 185, 129, 0.3);
        }

        .btn-expense {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 4px 6px rgba(239, 68, 68, 0.3);
        }

        .btn-transfer {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 0 4px 6px rgba(245, 158, 11, 0.3);
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .debt-card-owe {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .debt-card-lent {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .input-field {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 16px;
            transition: border-color 0.2s;
            -webkit-touch-callout: auto !important;
            -webkit-user-select: auto !important;
            user-select: auto !important;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .number-input {
            font-size: 18px;
            font-weight: 600;
        }
        
        .quick-amount {
            background: #f3f4f6;
            border-radius: 8px;
            padding: 8px 12px;
            font-weight: 500;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .quick-amount:active {
            background: #e5e7eb;
            transform: scale(0.95);
        }
        
        .quick-amount.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, memo } = React;

        const INITIAL_CATEGORIES = [
            {
                id: 'products',
                name: '–ü—Ä–æ–¥—É–∫—Ç—ã',
                icon: 'üçî',
                type: 'expense',
                subcategories: [
                    { id: 'drinks', name: '–ù–∞–ø–∏—Ç–∫–∏', icon: 'ü•§' },
                    { id: 'sweets', name: '–°–ª–∞–¥–∫–æ–µ', icon: 'üç¨' },
                    { id: 'fruits', name: '–§—Ä—É–∫—Ç—ã', icon: 'üçé' },
                    { id: 'vegetables', name: '–û–≤–æ—â–∏', icon: 'ü•¨' },
                    { id: 'other', name: '–î—Ä—É–≥–æ–µ', icon: 'üçû' }
                ]
            },
            {
                id: 'transport',
                name: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
                icon: 'üöó',
                type: 'expense',
                subcategories: [
                    { id: 'taxi', name: '–¢–∞–∫—Å–∏', icon: 'üöï' },
                    { id: 'metro', name: '–ú–µ—Ç—Ä–æ', icon: 'üöá' },
                    { id: 'bus', name: '–ê–≤—Ç–æ–±—É—Å', icon: 'üöå' }
                ]
            },
            {
                id: 'utilities',
                name: '–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ',
                icon: 'üè†',
                type: 'expense',
                subcategories: [
                    { id: 'water', name: '–í–æ–¥–∞', icon: 'üíß' },
                    { id: 'electricity', name: '–°–≤–µ—Ç', icon: '‚ö°' },
                    { id: 'gas', name: '–ì–∞–∑', icon: 'üî•' },
                    { id: 'trash', name: '–í—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞', icon: 'üóëÔ∏è' }
                ]
            },
            {
                id: 'communication',
                name: '–°–≤—è–∑—å',
                icon: 'üì±',
                type: 'expense',
                subcategories: [
                    { id: 'mobile', name: '–ú–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å', icon: 'üì±' },
                    { id: 'internet', name: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç', icon: 'üåê' }
                ]
            },
            {
                id: 'clothing',
                name: '–û–¥–µ–∂–¥–∞',
                icon: 'üëï',
                type: 'expense',
                subcategories: [
                    { id: 'clothes', name: '–û–¥–µ–∂–¥–∞', icon: 'üëï' },
                    { id: 'shoes', name: '–û–±—É–≤—å', icon: 'üëü' },
                    { id: 'accessories', name: '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã', icon: 'üëú' }
                ]
            },
            {
                id: 'income',
                name: '–î–æ—Ö–æ–¥',
                icon: 'üíº',
                type: 'income',
                subcategories: [
                    { id: 'salary', name: '–ó–∞—Ä–ø–ª–∞—Ç–∞', icon: 'üí∞' },
                    { id: 'bonus', name: '–ü—Ä–µ–º–∏—è', icon: 'üéÅ' },
                    { id: 'freelance', name: '–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞', icon: 'üíª' },
                    { id: 'other_income', name: '–î—Ä—É–≥–æ–µ', icon: 'üíµ' }
                ]
            }
        ];

        const INITIAL_ACCOUNTS = [
            { id: 'cash', name: '–ù–∞–ª–∏—á–Ω—ã–µ', icon: 'üíµ', balance: 0, color: '#10b981' },
            { id: 'kaspi', name: 'Kaspi Bank', icon: 'üîµ', balance: 0, color: '#3b82f6' },
            { id: 'bcc', name: '–ë–¶–ö', icon: 'üü¢', balance: 0, color: '#10b981' },
            { id: 'halyk', name: '–•–∞–ª—ã–∫ –ë–∞–Ω–∫', icon: 'üî¥', balance: 0, color: '#ef4444' },
            { id: 'card1', name: '–ö–∞—Ä—Ç–∞ 1', icon: 'üí≥', balance: 0, color: '#8b5cf6' }
        ];

        const QUICK_AMOUNTS = [100, 500, 1000, 2000, 5000, 10000];

        const TransactionModal = memo(({ 
            isOpen, 
            onClose, 
            categories, 
            accounts, 
            transactionType,
            onAddTransaction 
        }) => {
            const [form, setForm] = useState({
                amount: '',
                category: '',
                subcategory: '',
                account: '',
                toAccount: '',
                note: '',
                date: new Date().toISOString().split('T')[0]
            });
            
            const [localAmount, setLocalAmount] = useState('');

            useEffect(() => {
                if (isOpen) {
                    setLocalAmount('');
                    setForm({
                        amount: '',
                        category: '',
                        subcategory: '',
                        account: '',
                        toAccount: '',
                        note: '',
                        date: new Date().toISOString().split('T')[0]
                    });
                }
            }, [isOpen]);

            const handleAmountChange = useCallback((value) => {
                setLocalAmount(value);
                setForm(prev => ({ ...prev, amount: value }));
            }, []);

            const handleQuickAmount = useCallback((amount) => {
                const newAmount = localAmount ? (parseFloat(localAmount) || 0) + amount : amount;
                setLocalAmount(newAmount.toString());
                setForm(prev => ({ ...prev, amount: newAmount.toString() }));
            }, [localAmount]);

            const handleSubmit = useCallback(() => {
                if (!form.amount || parseFloat(form.amount) <= 0) {
                    alert('–£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É');
                    return;
                }

                if (transactionType !== 'transfer' && !form.category) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é');
                    return;
                }

                if (!form.account) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç');
                    return;
                }

                if (transactionType === 'transfer' && !form.toAccount) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è');
                    return;
                }

                if (transactionType === 'transfer' && form.account === form.toAccount) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–Ω—ã–µ —Å—á–µ—Ç–∞');
                    return;
                }

                onAddTransaction({
                    ...form,
                    type: transactionType,
                    amount: parseFloat(form.amount)
                });
                
                onClose();
            }, [form, transactionType, onAddTransaction, onClose]);

            if (!isOpen) return null;

            const selectedCategory = categories.find(c => c.id === form.category);

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <div className="p-6">
                            <h2 className="text-2xl font-bold mb-4">
                                {transactionType === 'income' ? 'üí∞ –î–æ—Ö–æ–¥' : 
                                 transactionType === 'expense' ? 'üí∏ –†–∞—Å—Ö–æ–¥' : 'üîÑ –ü–µ—Ä–µ–≤–æ–¥'}
                            </h2>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–°—É–º–º–∞ (‚Ç∏)</label>
                                    <input
                                        key="amount-input"
                                        type="number"
                                        inputMode="decimal"
                                        value={localAmount}
                                        onChange={(e) => handleAmountChange(e.target.value)}
                                        onBlur={(e) => handleAmountChange(e.target.value)}
                                        className="input-field number-input w-full"
                                        placeholder="0"
                                        autoFocus
                                    />
                                    
                                    <div className="flex flex-wrap gap-2 mt-3">
                                        {QUICK_AMOUNTS.map(amount => (
                                            <button
                                                key={amount}
                                                onClick={() => handleQuickAmount(amount)}
                                                className="quick-amount"
                                            >
                                                +{amount}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {transactionType !== 'transfer' && (
                                    <>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                            <select
                                                value={form.category}
                                                onChange={(e) => setForm({...form, category: e.target.value, subcategory: ''})}
                                                className="input-field w-full"
                                            >
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                                {categories
                                                    .filter(c => c.type === transactionType)
                                                    .map(cat => (
                                                        <option key={cat.id} value={cat.id}>
                                                            {cat.icon} {cat.name}
                                                        </option>
                                                    ))}
                                            </select>
                                        </div>

                                        {selectedCategory?.subcategories && (
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                                <select
                                                    value={form.subcategory}
                                                    onChange={(e) => setForm({...form, subcategory: e.target.value})}
                                                    className="input-field w-full"
                                                >
                                                    <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–∞</option>
                                                    {selectedCategory.subcategories.map(sub => (
                                                        <option key={sub.id} value={sub.id}>
                                                            {sub.icon} {sub.name}
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>
                                        )}
                                    </>
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        {transactionType === 'transfer' ? '–û—Ç–∫—É–¥–∞' : '–°—á—ë—Ç'}
                                    </label>
                                    <select
                                        value={form.account}
                                        onChange={(e) => setForm({...form, account: e.target.value})}
                                        className="input-field w-full"
                                    >
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç</option>
                                        {accounts.map(acc => (
                                            <option key={acc.id} value={acc.id}>
                                                {acc.icon} {acc.name} ({acc.balance.toLocaleString()}‚Ç∏)
                                            </option>
                                        ))}
                                    </select>
                                </div>

                                {transactionType === 'transfer' && (
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">–ö—É–¥–∞</label>
                                        <select
                                            value={form.toAccount}
                                            onChange={(e) => setForm({...form, toAccount: e.target.value})}
                                            className="input-field w-full"
                                        >
                                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á—ë—Ç</option>
                                            {accounts.filter(a => a.id !== form.account).map(acc => (
                                                <option key={acc.id} value={acc.id}>
                                                    {acc.icon} {acc.name} ({acc.balance.toLocaleString()}‚Ç∏)
                                                </option>
                                            ))}
                                        </select>
                                    </div>
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–î–∞—Ç–∞</label>
                                    <input
                                        type="date"
                                        value={form.date}
                                        onChange={(e) => setForm({...form, date: e.target.value})}
                                        className="input-field w-full"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–ó–∞–º–µ—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                                    <textarea
                                        value={form.note}
                                        onChange={(e) => setForm({...form, note: e.target.value})}
                                        className="input-field w-full resize-none"
                                        rows="3"
                                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—É–ø–∏–ª –≤ –ú–∞–≥–Ω—É–º–µ"
                                    />
                                </div>
                            </div>

                            <div className="flex gap-3 mt-6">
                                <button onClick={handleSubmit} className="flex-1 btn-primary">
                                    –î–æ–±–∞–≤–∏—Ç—å
                                </button>
                                <button
                                    onClick={onClose}
                                    className="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl font-semibold"
                                >
                                    –û—Ç–º–µ–Ω–∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        });

        const DebtModal = memo(({ isOpen, onClose, onAddDebt }) => {
            const [form, setForm] = useState({
                type: 'owe',
                person: '',
                amount: '',
                note: '',
                date: new Date().toISOString().split('T')[0]
            });
            
            const [localAmount, setLocalAmount] = useState('');

            useEffect(() => {
                if (isOpen) {
                    setLocalAmount('');
                    setForm({
                        type: 'owe',
                        person: '',
                        amount: '',
                        note: '',
                        date: new Date().toISOString().split('T')[0]
                    });
                }
            }, [isOpen]);

            const handleAmountChange = useCallback((value) => {
                setLocalAmount(value);
                setForm(prev => ({ ...prev, amount: value }));
            }, []);

            const handleQuickAmount = useCallback((amount) => {
                const newAmount = localAmount ? (parseFloat(localAmount) || 0) + amount : amount;
                setLocalAmount(newAmount.toString());
                setForm(prev => ({ ...prev, amount: newAmount.toString() }));
            }, [localAmount]);

            const handleSubmit = useCallback(() => {
                if (!form.person.trim()) {
                    alert('–£–∫–∞–∂–∏—Ç–µ –∏–º—è');
                    return;
                }

                if (!form.amount || parseFloat(form.amount) <= 0) {
                    alert('–£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É');
                    return;
                }

                onAddDebt({
                    ...form,
                    amount: parseFloat(form.amount)
                });
                
                onClose();
            }, [form, onAddDebt, onClose]);

            if (!isOpen) return null;

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <div className="p-6">
                            <h2 className="text-2xl font-bold mb-4">üìù –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ª–≥</h2>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–¢–∏–ø –¥–æ–ª–≥–∞</label>
                                    <div className="grid grid-cols-2 gap-3">
                                        <button
                                            onClick={() => setForm({...form, type: 'owe'})}
                                            className={`py-3 px-4 rounded-xl font-semibold ${form.type === 'owe' ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-700'}`}
                                        >
                                            ‚ùå –Ø –¥–æ–ª–∂–µ–Ω
                                        </button>
                                        <button
                                            onClick={() => setForm({...form, type: 'lent'})}
                                            className={`py-3 px-4 rounded-xl font-semibold ${form.type === 'lent' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'}`}
                                        >
                                            ‚úÖ –ú–Ω–µ –¥–æ–ª–∂–Ω—ã
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        {form.type === 'owe' ? '–ö–æ–º—É —è –¥–æ–ª–∂–µ–Ω' : '–ö—Ç–æ –º–Ω–µ –¥–æ–ª–∂–µ–Ω'}
                                    </label>
                                    <input
                                        type="text"
                                        value={form.person}
                                        onChange={(e) => setForm({...form, person: e.target.value})}
                                        className="input-field w-full"
                                        placeholder="–ò–º—è"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–°—É–º–º–∞ (‚Ç∏)</label>
                                    <input
                                        type="number"
                                        inputMode="decimal"
                                        value={localAmount}
                                        onChange={(e) => handleAmountChange(e.target.value)}
                                        onBlur={(e) => handleAmountChange(e.target.value)}
                                        className="input-field number-input w-full"
                                        placeholder="0"
                                    />
                                    
                                    <div className="flex flex-wrap gap-2 mt-3">
                                        {QUICK_AMOUNTS.map(amount => (
                                            <button
                                                key={amount}
                                                onClick={() => handleQuickAmount(amount)}
                                                className="quick-amount"
                                            >
                                                +{amount}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–î–∞—Ç–∞</label>
                                    <input
                                        type="date"
                                        value={form.date}
                                        onChange={(e) => setForm({...form, date: e.target.value})}
                                        className="input-field w-full"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–ó–∞–º–µ—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                                    <textarea
                                        value={form.note}
                                        onChange={(e) => setForm({...form, note: e.target.value})}
                                        className="input-field w-full resize-none"
                                        rows="3"
                                        placeholder="–ó–∞ —á—Ç–æ –¥–æ–ª–≥..."
                                    />
                                </div>
                            </div>

                            <div className="flex gap-3 mt-6">
                                <button onClick={handleSubmit} className="flex-1 btn-primary">
                                    –î–æ–±–∞–≤–∏—Ç—å
                                </button>
                                <button
                                    onClick={onClose}
                                    className="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl font-semibold"
                                >
                                    –û—Ç–º–µ–Ω–∞
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        });

        function App() {
            const [activeTab, setActiveTab] = useState('home');
            const [categories, setCategories] = useState([]);
            const [accounts, setAccounts] = useState([]);
            const [transactions, setTransactions] = useState([]);
            const [debts, setDebts] = useState([]);
            
            const [showAddTransaction, setShowAddTransaction] = useState(false);
            const [transactionType, setTransactionType] = useState('expense');
            const [showAddDebt, setShowAddDebt] = useState(false);
            const [searchQuery, setSearchQuery] = useState('');
            const [filterCategory, setFilterCategory] = useState('all');
            const [filterAccount, setFilterAccount] = useState('all');
            const [filterMonth, setFilterMonth] = useState('current');

            useEffect(() => {
                const savedCategories = localStorage.getItem('financeApp_categories_v2');
                const savedAccounts = localStorage.getItem('financeApp_accounts_v2');
                const savedTransactions = localStorage.getItem('financeApp_transactions_v2');
                const savedDebts = localStorage.getItem('financeApp_debts_v2');
                
                setCategories(savedCategories ? JSON.parse(savedCategories) : INITIAL_CATEGORIES);
                setAccounts(savedAccounts ? JSON.parse(savedAccounts) : INITIAL_ACCOUNTS);
                setTransactions(savedTransactions ? JSON.parse(savedTransactions) : []);
                setDebts(savedDebts ? JSON.parse(savedDebts) : []);
            }, []);

            const saveToLocalStorage = useCallback((key, data) => {
                localStorage.setItem(key, JSON.stringify(data));
            }, []);

            useEffect(() => {
                if (categories.length > 0) saveToLocalStorage('financeApp_categories_v2', categories);
            }, [categories, saveToLocalStorage]);
            useEffect(() => {
                if (accounts.length > 0) saveToLocalStorage('financeApp_accounts_v2', accounts);
            }, [accounts, saveToLocalStorage]);
            useEffect(() => {
                saveToLocalStorage('financeApp_transactions_v2', transactions);
            }, [transactions, saveToLocalStorage]);
            useEffect(() => {
                saveToLocalStorage('financeApp_debts_v2', debts);
            }, [debts, saveToLocalStorage]);

            const handleAddTransaction = useCallback((transactionData) => {
                const transaction = {
                    id: Date.now(),
                    ...transactionData,
                    timestamp: new Date().toISOString()
                };

                setAccounts(prev => prev.map(acc => {
                    if (transactionData.type === 'income' && acc.id === transactionData.account) {
                        return { ...acc, balance: acc.balance + transactionData.amount };
                    }
                    if (transactionData.type === 'expense' && acc.id === transactionData.account) {
                        return { ...acc, balance: acc.balance - transactionData.amount };
                    }
                    if (transactionData.type === 'transfer') {
                        if (acc.id === transactionData.account) {
                            return { ...acc, balance: acc.balance - transactionData.amount };
                        }
                        if (acc.id === transactionData.toAccount) {
                            return { ...acc, balance: acc.balance + transactionData.amount };
                        }
                    }
                    return acc;
                }));

                setTransactions(prev => [transaction, ...prev]);
            }, []);

            const handleAddDebt = useCallback((debtData) => {
                const debt = {
                    id: Date.now(),
                    ...debtData,
                    paid: false
                };

                setDebts(prev => [debt, ...prev]);
            }, []);

            const markDebtPaid = useCallback((debtId) => {
                setDebts(prev => prev.map(d => 
                    d.id === debtId ? {...d, paid: true} : d
                ));
            }, []);

            const deleteDebt = useCallback((debtId) => {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–ª–≥?')) {
                    setDebts(prev => prev.filter(d => d.id !== debtId));
                }
            }, []);

            const calculations = useMemo(() => {
                const totalBalance = accounts.reduce((sum, acc) => sum + acc.balance, 0);
                
                const currentMonth = new Date().getMonth();
                const currentYear = new Date().getFullYear();
                
                const monthTransactions = transactions.filter(tx => {
                    const txDate = new Date(tx.date);
                    return txDate.getMonth() === currentMonth && txDate.getFullYear() === currentYear;
                });

                const monthIncome = monthTransactions
                    .filter(tx => tx.type === 'income')
                    .reduce((sum, tx) => sum + tx.amount, 0);

                const monthExpenses = monthTransactions
                    .filter(tx => tx.type === 'expense')
                    .reduce((sum, tx) => sum + tx.amount, 0);

                const expensesByCategory = {};
                monthTransactions
                    .filter(tx => tx.type === 'expense')
                    .forEach(tx => {
                        const cat = categories.find(c => c.id === tx.category);
                        if (cat) {
                            if (!expensesByCategory[cat.name]) {
                                expensesByCategory[cat.name] = { amount: 0, icon: cat.icon };
                            }
                            expensesByCategory[cat.name].amount += tx.amount;
                        }
                    });

                const activeDebts = debts.filter(d => !d.paid);
                const totalOwe = activeDebts.filter(d => d.type === 'owe').reduce((sum, d) => sum + d.amount, 0);
                const totalLent = activeDebts.filter(d => d.type === 'lent').reduce((sum, d) => sum + d.amount, 0);
                const debtBalance = totalLent - totalOwe;

                return {
                    totalBalance,
                    monthIncome,
                    monthExpenses,
                    monthBalance: monthIncome - monthExpenses,
                    expensesByCategory,
                    totalOwe,
                    totalLent,
                    debtBalance
                };
            }, [accounts, transactions, categories, debts]);

            const filteredTransactions = useMemo(() => {
                let result = [...transactions];

                if (searchQuery) {
                    result = result.filter(tx => 
                        tx.note?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        accounts.find(a => a.id === tx.account)?.name.toLowerCase().includes(searchQuery.toLowerCase())
                    );
                }

                if (filterCategory !== 'all') {
                    result = result.filter(tx => tx.category === filterCategory);
                }

                if (filterAccount !== 'all') {
                    result = result.filter(tx => tx.account === filterAccount || tx.toAccount === filterAccount);
                }

                if (filterMonth === 'current') {
                    const currentMonth = new Date().getMonth();
                    const currentYear = new Date().getFullYear();
                    result = result.filter(tx => {
                        const txDate = new Date(tx.date);
                        return txDate.getMonth() === currentMonth && txDate.getFullYear() === currentYear;
                    });
                }

                return result;
            }, [transactions, searchQuery, filterCategory, filterAccount, filterMonth, accounts]);

            const groupedTransactions = useMemo(() => {
                const groups = {};
                filteredTransactions.forEach(tx => {
                    const date = new Date(tx.date).toLocaleDateString('ru-RU', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                    if (!groups[date]) {
                        groups[date] = [];
                    }
                    groups[date].push(tx);
                });
                return groups;
            }, [filteredTransactions]);

            const DebtsTab = () => {
                const activeDebts = debts.filter(d => !d.paid);
                const paidDebts = debts.filter(d => d.paid);

                return (
                    <div className="p-4 pb-32">
                        <h2 className="text-2xl font-bold mb-4">üìä –î–æ–ª–≥–∏</h2>

                        <div className="grid grid-cols-2 gap-3 mb-6">
                            <div className="stat-card border-2 border-red-200">
                                <p className="text-sm text-gray-600 mb-1">‚ùå –Ø –¥–æ–ª–∂–µ–Ω</p>
                                <p className="text-2xl font-bold text-red-600">{calculations.totalOwe.toLocaleString()} ‚Ç∏</p>
                            </div>
                            <div className="stat-card border-2 border-green-200">
                                <p className="text-sm text-gray-600 mb-1">‚úÖ –ú–Ω–µ –¥–æ–ª–∂–Ω—ã</p>
                                <p className="text-2xl font-bold text-green-600">{calculations.totalLent.toLocaleString()} ‚Ç∏</p>
                            </div>
                        </div>

                        <div className="stat-card mb-6">
                            <p className="text-sm text-gray-600 mb-1">–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –¥–æ–ª–≥–æ–≤</p>
                            <p className={`text-3xl font-bold ${calculations.debtBalance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                {calculations.debtBalance >= 0 ? '+' : ''}{calculations.debtBalance.toLocaleString()} ‚Ç∏
                            </p>
                        </div>

                        <button
                            onClick={() => setShowAddDebt(true)}
                            className="w-full btn-primary mb-6"
                        >
                            + –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ª–≥
                        </button>

                        <h3 className="font-bold text-lg mb-3">–ê–∫—Ç–∏–≤–Ω—ã–µ –¥–æ–ª–≥–∏</h3>
                        {activeDebts.length > 0 ? (
                            <div className="space-y-3 mb-6">
                                {activeDebts.map(debt => (
                                    <div key={debt.id} className={`transaction-card ${debt.type === 'owe' ? 'border-l-4 border-red-500' : 'border-l-4 border-green-500'}`}>
                                        <div className="flex items-start justify-between mb-2">
                                            <div className="flex-1">
                                                <p className="font-semibold text-gray-800">
                                                    {debt.type === 'owe' ? '‚ùå' : '‚úÖ'} {debt.person}
                                                </p>
                                                {debt.note && <p className="text-sm text-gray-500 mt-1">"{debt.note}"</p>}
                                                <p className="text-xs text-gray-400 mt-1">
                                                    {new Date(debt.date).toLocaleDateString('ru-RU')}
                                                </p>
                                            </div>
                                            <p className={`text-xl font-bold ${debt.type === 'owe' ? 'text-red-600' : 'text-green-600'}`}>
                                                {debt.amount.toLocaleString()} ‚Ç∏
                                            </p>
                                        </div>
                                        <div className="flex gap-2 mt-3">
                                            <button
                                                onClick={() => markDebtPaid(debt.id)}
                                                className="flex-1 bg-green-500 text-white py-2 px-4 rounded-lg text-sm font-semibold"
                                            >
                                                ‚úì –ü–æ–≥–∞—à–µ–Ω–æ
                                            </button>
                                            <button
                                                onClick={() => deleteDebt(debt.id)}
                                                className="bg-red-500 text-white py-2 px-4 rounded-lg text-sm font-semibold"
                                            >
                                                –£–¥–∞–ª–∏—Ç—å
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <p className="text-center text-gray-400 py-8 mb-6">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–ª–≥–æ–≤</p>
                        )}

                        {paidDebts.length > 0 && (
                            <>
                                <h3 className="font-bold text-lg mb-3 text-gray-500">–ü–æ–≥–∞—à–µ–Ω–Ω—ã–µ –¥–æ–ª–≥–∏</h3>
                                <div className="space-y-3">
                                    {paidDebts.map(debt => (
                                        <div key={debt.id} className="transaction-card opacity-50">
                                            <div className="flex items-start justify-between">
                                                <div className="flex-1">
                                                    <p className="font-semibold text-gray-800">
                                                        {debt.type === 'owe' ? '‚ùå' : '‚úÖ'} {debt.person}
                                                    </p>
                                                    {debt.note && <p className="text-sm text-gray-500 mt-1">"{debt.note}"</p>}
                                                    <p className="text-xs text-green-600 mt-1 font-semibold">‚úì –ü–æ–≥–∞—à–µ–Ω–æ</p>
                                                </div>
                                                <p className="text-xl font-bold text-gray-400 line-through">
                                                    {debt.amount.toLocaleString()} ‚Ç∏
                                                </p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </>
                        )}
                    </div>
                );
            };

            const HomeTab = () => (
                <div className="p-4 pb-32">
                    <div className="account-card mb-6">
                        <p className="text-sm opacity-90 mb-1">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</p>
                        <p className="text-4xl font-bold">{calculations.totalBalance.toLocaleString()} ‚Ç∏</p>
                    </div>

                    <div className="bg-white rounded-xl p-4 mb-6 shadow-sm">
                        <h3 className="font-semibold text-gray-700 mb-3">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</h3>
                        <div className="space-y-2">
                            <div className="flex justify-between items-center">
                                <span className="text-gray-600">üí∞ –î–æ—Ö–æ–¥—ã</span>
                                <span className="font-semibold text-green-600">+{calculations.monthIncome.toLocaleString()} ‚Ç∏</span>
                            </div>
                            <div className="flex justify-between items-center">
                                <span className="text-gray-600">üí∏ –†–∞—Å—Ö–æ–¥—ã</span>
                                <span className="font-semibold text-red-600">-{calculations.monthExpenses.toLocaleString()} ‚Ç∏</span>
                            </div>
                            <div className="border-t pt-2 mt-2">
                                <div className="flex justify-between items-center">
                                    <span className="font-semibold text-gray-700">–ë–∞–ª–∞–Ω—Å</span>
                                    <span className={`font-bold text-lg ${calculations.monthBalance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        {calculations.monthBalance >= 0 ? '+' : ''}{calculations.monthBalance.toLocaleString()} ‚Ç∏
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3 className="font-bold text-lg mb-3 text-gray-800">–ú–æ–∏ —Å—á–µ—Ç–∞</h3>
                    <div className="space-y-3 mb-6">
                        {accounts.map(acc => (
                            <div key={acc.id} className="bg-white rounded-xl p-4 shadow-sm flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <div className="text-3xl">{acc.icon}</div>
                                    <div>
                                        <p className="font-semibold text-gray-800">{acc.name}</p>
                                    </div>
                                </div>
                                <p className="font-bold text-lg" style={{color: acc.color}}>
                                    {acc.balance.toLocaleString()} ‚Ç∏
                                </p>
                            </div>
                        ))}
                    </div>

                    <div className="grid grid-cols-3 gap-3 mb-6">
                        <button
                            onClick={() => {
                                setTransactionType('income');
                                setShowAddTransaction(true);
                            }}
                            className="btn-primary btn-income text-sm py-4"
                        >
                            <div>‚ûï</div>
                            <div className="mt-1">–î–æ—Ö–æ–¥</div>
                        </button>
                        <button
                            onClick={() => {
                                setTransactionType('expense');
                                setShowAddTransaction(true);
                            }}
                            className="btn-primary btn-expense text-sm py-4"
                        >
                            <div>‚ûñ</div>
                            <div className="mt-1">–†–∞—Å—Ö–æ–¥</div>
                        </button>
                        <button
                            onClick={() => {
                                setTransactionType('transfer');
                                setShowAddTransaction(true);
                            }}
                            className="btn-primary btn-transfer text-sm py-4"
                        >
                            <div>üîÑ</div>
                            <div className="mt-1">–ü–µ—Ä–µ–≤–æ–¥</div>
                        </button>
                    </div>

                    <h3 className="font-bold text-lg mb-3 text-gray-800">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                    {transactions.slice(0, 5).map(tx => {
                        const cat = categories.find(c => c.id === tx.category);
                        const subcat = cat?.subcategories?.find(s => s.id === tx.subcategory);
                        const acc = accounts.find(a => a.id === tx.account);
                        const toAcc = accounts.find(a => a.id === tx.toAccount);

                        return (
                            <div key={tx.id} className="transaction-card">
                                <div className="flex items-start justify-between">
                                    <div className="flex items-start gap-3 flex-1">
                                        <div className="text-2xl">
                                            {tx.type === 'transfer' ? 'üîÑ' : cat?.icon || 'üí∞'}
                                        </div>
                                        <div className="flex-1">
                                            <p className="font-semibold text-gray-800">
                                                {tx.type === 'transfer' ? 
                                                    `${acc?.name} ‚Üí ${toAcc?.name}` :
                                                    `${cat?.name}${subcat ? ` ‚Üí ${subcat.name}` : ''}`
                                                }
                                            </p>
                                            {tx.note && <p className="text-sm text-gray-500 mt-1">"{tx.note}"</p>}
                                            <p className="text-xs text-gray-400 mt-1">
                                                {new Date(tx.date).toLocaleDateString('ru-RU')} ‚Ä¢ {acc?.name}
                                            </p>
                                        </div>
                                    </div>
                                    <div className={`font-bold text-lg ${tx.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                                        {tx.type === 'income' ? '+' : '-'}{tx.amount.toLocaleString()} ‚Ç∏
                                    </div>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );

            const HistoryTab = () => (
                <div className="p-4 pb-32">
                    <input
                        type="text"
                        placeholder="üîç –ü–æ–∏—Å–∫..."
                        value={searchQuery}
                        onChange={(e) => setSearchQuery(e.target.value)}
                        className="input-field w-full mb-4"
                    />

                    <div className="grid grid-cols-3 gap-2 mb-4">
                        <select
                            value={filterCategory}
                            onChange={(e) => setFilterCategory(e.target.value)}
                            className="input-field text-sm"
                        >
                            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            {categories.map(cat => (
                                <option key={cat.id} value={cat.id}>{cat.icon} {cat.name}</option>
                            ))}
                        </select>

                        <select
                            value={filterAccount}
                            onChange={(e) => setFilterAccount(e.target.value)}
                            className="input-field text-sm"
                        >
                            <option value="all">–í—Å–µ —Å—á–µ—Ç–∞</option>
                            {accounts.map(acc => (
                                <option key={acc.id} value={acc.id}>{acc.icon} {acc.name}</option>
                            ))}
                        </select>

                        <select
                            value={filterMonth}
                            onChange={(e) => setFilterMonth(e.target.value)}
                            className="input-field text-sm"
                        >
                            <option value="current">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option>
                            <option value="all">–í—Å—ë –≤—Ä–µ–º—è</option>
                        </select>
                    </div>

                    {Object.entries(groupedTransactions).map(([date, txs]) => (
                        <div key={date} className="mb-6">
                            <p className="text-sm font-semibold text-gray-500 mb-2">{date}</p>
                            {txs.map(tx => {
                                const cat = categories.find(c => c.id === tx.category);
                                const subcat = cat?.subcategories?.find(s => s.id === tx.subcategory);
                                const acc = accounts.find(a => a.id === tx.account);
                                const toAcc = accounts.find(a => a.id === tx.toAccount);

                                return (
                                    <div key={tx.id} className="transaction-card">
                                        <div className="flex items-start justify-between">
                                            <div className="flex items-start gap-3 flex-1">
                                                <div className="text-2xl">
                                                    {tx.type === 'transfer' ? 'üîÑ' : cat?.icon || 'üí∞'}
                                                </div>
                                                <div className="flex-1">
                                                    <p className="font-semibold text-gray-800">
                                                        {tx.type === 'transfer' ? 
                                                            `${acc?.name} ‚Üí ${toAcc?.name}` :
                                                            `${cat?.name}${subcat ? ` ‚Üí ${subcat.name}` : ''}`
                                                        }
                                                    </p>
                                                    {tx.note && <p className="text-sm text-gray-500 mt-1">"{tx.note}"</p>}
                                                    <p className="text-xs text-gray-400 mt-1">
                                                        {new Date(tx.timestamp).toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})} ‚Ä¢ {acc?.name}
                                                    </p>
                                                </div>
                                            </div>
                                            <div className={`font-bold text-lg ${tx.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                                                {tx.type === 'income' ? '+' : '-'}{tx.amount.toLocaleString()} ‚Ç∏
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    ))}

                    {filteredTransactions.length === 0 && (
                        <div className="text-center py-12 text-gray-400">
                            <p className="text-4xl mb-2">üì≠</p>
                            <p>–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</p>
                        </div>
                    )}
                </div>
            );

            const StatsTab = () => (
                <div className="p-4 pb-32">
                    <h2 className="text-2xl font-bold mb-4">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    
                    <div className="stat-card mb-6">
                        <h3 className="font-semibold text-gray-700 mb-4">
                            {new Date().toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' })}
                        </h3>
                        
                        <div className="space-y-3 mb-4">
                            <div className="flex justify-between items-center py-2 border-b">
                                <span className="text-gray-600">üí∞ –î–æ—Ö–æ–¥—ã</span>
                                <span className="font-bold text-green-600 text-lg">+{calculations.monthIncome.toLocaleString()} ‚Ç∏</span>
                            </div>
                            <div className="flex justify-between items-center py-2 border-b">
                                <span className="text-gray-600">üí∏ –†–∞—Å—Ö–æ–¥—ã</span>
                                <span className="font-bold text-red-600 text-lg">-{calculations.monthExpenses.toLocaleString()} ‚Ç∏</span>
                            </div>
                            <div className="flex justify-between items-center py-2">
                                <span className="font-semibold text-gray-700">–ë–∞–ª–∞–Ω—Å</span>
                                <span className={`font-bold text-xl ${calculations.monthBalance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                    {calculations.monthBalance >= 0 ? '+' : ''}{calculations.monthBalance.toLocaleString()} ‚Ç∏
                                </span>
                            </div>
                        </div>
                    </div>

                    <div className="stat-card">
                        <h3 className="font-semibold text-gray-700 mb-4">–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                        
                        {Object.entries(calculations.expensesByCategory).length > 0 ? (
                            <div className="space-y-3">
                                {Object.entries(calculations.expensesByCategory)
                                    .sort((a, b) => b[1].amount - a[1].amount)
                                    .map(([name, data]) => {
                                        const percentage = calculations.monthExpenses > 0 ? 
                                            ((data.amount / calculations.monthExpenses) * 100).toFixed(0) : 0;
                                        return (
                                            <div key={name}>
                                                <div className="flex justify-between items-center mb-1">
                                                    <span className="text-sm text-gray-600">{data.icon} {name}</span>
                                                    <span className="font-semibold">{data.amount.toLocaleString()} ‚Ç∏ ({percentage}%)</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-2">
                                                    <div 
                                                        className="bg-gradient-to-r from-purple-500 to-blue-500 h-2 rounded-full"
                                                        style={{width: `${percentage}%`}}
                                                    />
                                                </div>
                                            </div>
                                        );
                                    })}
                            </div>
                        ) : (
                            <p className="text-center text-gray-400 py-8">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</p>
                        )}
                    </div>
                </div>
            );

            const SettingsTab = () => (
                <div className="p-4 pb-32">
                    <h2 className="text-2xl font-bold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

                    <div className="space-y-3">
                        <button className="w-full bg-white rounded-xl p-4 shadow-sm text-left flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <span className="text-2xl">üìÇ</span>
                                <span className="font-semibold">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</span>
                            </div>
                            <span className="text-gray-400">‚Üí</span>
                        </button>

                        <button className="w-full bg-white rounded-xl p-4 shadow-sm text-left flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <span className="text-2xl">üí≥</span>
                                <span className="font-semibold">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏</span>
                            </div>
                            <span className="text-gray-400">‚Üí</span>
                        </button>

                        <button 
                            onClick={() => {
                                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!')) {
                                    setAccounts(INITIAL_ACCOUNTS);
                                    setTransactions([]);
                                    setCategories(INITIAL_CATEGORIES);
                                    setDebts([]);
                                }
                            }}
                            className="w-full bg-white rounded-xl p-4 shadow-sm text-left flex items-center justify-between border-2 border-red-200"
                        >
                            <div className="flex items-center gap-3">
                                <span className="text-2xl">üóëÔ∏è</span>
                                <span className="font-semibold text-red-600">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</span>
                            </div>
                        </button>
                    </div>

                    <div className="mt-8 text-center text-sm text-gray-400">
                        <p>üí∞ –ú–æ–∏ –§–∏–Ω–∞–Ω—Å—ã v1.2</p>
                        <p className="mt-1">–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ</p>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white sticky top-0 z-10 shadow-lg">
                        <h1 className="text-2xl font-bold text-center pt-4 px-4">üí∞ –ú–æ–∏ –§–∏–Ω–∞–Ω—Å—ã</h1>
                        <p className="text-center text-sm opacity-90 pb-3">–£—á—ë—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤</p>
                        
                        <div className="flex bg-blue-700 text-white">
                            <button
                                onClick={() => setActiveTab('home')}
                                className={`tab-button ${activeTab === 'home' ? 'active bg-gray-50' : ''}`}
                            >
                                üè† –ì–ª–∞–≤–Ω–∞—è
                            </button>
                            <button
                                onClick={() => setActiveTab('debts')}
                                className={`tab-button ${activeTab === 'debts' ? 'active bg-gray-50' : ''}`}
                            >
                                üìù –î–æ–ª–≥–∏
                            </button>
                            <button
                                onClick={() => setActiveTab('history')}
                                className={`tab-button ${activeTab === 'history' ? 'active bg-gray-50' : ''}`}
                            >
                                üìú –ò—Å—Ç–æ—Ä–∏—è
                            </button>
                            <button
                                onClick={() => setActiveTab('stats')}
                                className={`tab-button ${activeTab === 'stats' ? 'active bg-gray-50' : ''}`}
                            >
                                üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </button>
                            <button
                                onClick={() => setActiveTab('settings')}
                                className={`tab-button ${activeTab === 'settings' ? 'active bg-gray-50' : ''}`}
                            >
                                ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    </div>

                    {activeTab === 'home' && <HomeTab />}
                    {activeTab === 'debts' && <DebtsTab />}
                    {activeTab === 'history' && <HistoryTab />}
                    {activeTab === 'stats' && <StatsTab />}
                    {activeTab === 'settings' && <SettingsTab />}

                    <TransactionModal
                        isOpen={showAddTransaction}
                        onClose={() => setShowAddTransaction(false)}
                        categories={categories}
                        accounts={accounts}
                        transactionType={transactionType}
                        onAddTransaction={handleAddTransaction}
                    />

                    <DebtModal
                        isOpen={showAddDebt}
                        onClose={() => setShowAddDebt(false)}
                        onAddDebt={handleAddDebt}
                    />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
